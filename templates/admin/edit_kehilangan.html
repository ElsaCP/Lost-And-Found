<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Edit Laporan Kehilangan</title>
  <link rel="stylesheet" href="{{ url_for('admin_bp.static', filename='css/detail_kehilangan.css') }}">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
</head>
<body>

  <!-- Sidebar -->
  <div class="sidebar">
    <div>
      <div class="logo-wrapper">
        <img src="{{ url_for('admin_bp.static', filename='image/rectangle.png')}}" class="rectangle-bg">
        <img src="{{ url_for('admin_bp.static', filename='image/logo.png')}}" class="logo-front">
      </div>
    <nav>
      <a href="{{ url_for('admin_bp.beranda_admin') }}"><i class="bi bi-speedometer2"></i> Beranda</a>
      <a href="#" class="active"><i class="bi bi-question-circle"></i> Kehilangan</a>
      <div class="submenu">
        <a href="{{ url_for('admin_bp.daftar_kehilangan') }}" class="active"><i class="bi bi-list-ul"></i> Daftar Barang</a>
        <a href="{{ url_for('admin_bp.tambah_kehilangan') }}"><i class="bi bi-plus-circle"></i> Tambah</a>
      </div>
      <a href="{{ url_for('admin_bp.daftar_penemuan') }}"><i class="bi bi-archive"></i> Penemuan</a>
      <a href="{{ url_for('admin_bp.arsip') }}"><i class="bi bi-folder"></i> Arsip</a>
      <a href="{{ url_for('admin_bp.pengaturan') }}"><i class="bi bi-gear"></i> Pengaturan</a>
    </nav>
  </div>
  
    <a href="{{ url_for('admin_bp.logout_admin') }}" class="logout">
      <i class="bi bi-box-arrow-right"></i> Logout
    </a>
  </div>

  <!-- MAIN CONTENT -->
  <div class="content">
    <div class="header">
      <div class="logo-wrapper">
        <img src="{{ url_for('admin_bp.static', filename='image/rectangle2.png')}}" alt="Rectangle Background" class="rectangle-bg">
        <img src="{{ url_for('admin_bp.static', filename='image/image5.png')}}" alt="Logo Header" class="logo-front">
      </div>
      <h2>Edit Laporan Kehilangan</h2>
      <div class="profile-icon"
            onclick="window.location.href='{{ url_for('admin_bp.pengaturan') }}'"
            style="cursor:pointer;">
            {% if global_admin and global_admin.photo %}
              <img src="{{ url_for('admin_bp.static', filename='upload/' ~ global_admin.photo) }}"
                  class="profile-header-img">
            {% else %}
              <i class="bi bi-person-circle"></i>
            {% endif %}
        </div>
    </div>

    <div class="detail-container">
      <div class="left-panel">
        <img id="fotoBarang" class="foto-barang" 
             src="{{ url_for('static', filename='uploads/' ~ (laporan.foto if laporan.foto else 'placeholder.png')) }}" 
             alt="Foto Barang">
        <div id="kodeLaporan" class="kode-laporan">{{ laporan.kode_kehilangan }}</div>
      </div>

<div class="right-panel">
  <form id="formEditKehilangan"
        action="{{ url_for('admin_bp.edit_kehilangan') }}?kode={{ laporan.kode_kehilangan }}"
        method="POST">

    <input type="hidden" name="from" value="{{ from_page }}">

    <!-- === DATA PELAPOR === -->
    <div class="data-section">
      <h3>Data Pelapor</h3>

      <div class="data-row">
        <span>Nama :</span>
        <input type="text" name="nama_pelapor" value="{{ laporan.nama_pelapor }}">
      </div>

      <div class="data-row">
        <span>No. Telp :</span>
        <input type="text" name="no_telp" value="{{ laporan.no_telp }}">
      </div>

      <div class="data-row">
        <span>Email :</span>
        <input type="email" name="email" value="{{ laporan.email }}">
      </div>

      <div class="data-row">
        <span>Asal Negara :</span>
        <input type="text" name="asal_negara" value="{{ laporan.asal_negara }}">
      </div>

      <div class="data-row">
        <span>Kota :</span>
        <input type="text" name="kota" value="{{ laporan.kota }}">
      </div>
    </div>

    <!-- === DATA BARANG === -->
    <div class="data-section">
      <h3>Data Barang</h3>

      <div class="data-row">
        <span>Nama Barang :</span>
        <input type="text" name="nama_barang" value="{{ laporan.nama_barang }}">
      </div>

      <div class="data-row">
        <span>Kategori :</span>
        <select name="kategori">
          <option value="Elektronik" {% if laporan.kategori == 'Elektronik' %}selected{% endif %}>Elektronik</option>
          <option value="Dompet" {% if laporan.kategori == 'Dompet' %}selected{% endif %}>Dompet</option>
          <option value="Tas" {% if laporan.kategori == 'Tas' %}selected{% endif %}>Tas</option>
          <option value="Kunci" {% if laporan.kategori == 'Kunci' %}selected{% endif %}>Kunci</option>
          <option value="Pakaian & Aksesori" {% if laporan.kategori == 'Pakaian & Aksesori' %}selected{% endif %}>Pakaian & Aksesori</option>
          <option value="Kendaraan & Aksesori Kendaraan" {% if laporan.kategori == 'Kendaraan & Aksesori Kendaraan' %}selected{% endif %}>Kendaraan & Aksesori Kendaraan</option>
          <option value="Barang Lainnya" {% if laporan.kategori == 'Barang Lainnya' %}selected{% endif %}>Barang Lainnya</option>
        </select>
      </div>

      <div class="data-row">
        <span>Jenis Laporan :</span>
        <input type="text" name="jenis_laporan" value="{{ laporan.jenis_laporan }}" readonly>
      </div>

<div class="data-row">
  <span>Lokasi Kehilangan</span>
</div>

<div class="form-row">
  <label for="terminal">Terminal :</label>
  <select id="terminal" name="terminal" class="form-select"
        data-terminal="{{ laporan.terminal }}" required>
      <option value="">Pilih Terminal</option>
      <option value="Terminal 1" {% if laporan.terminal == "Terminal 1" %}selected{% endif %}>Terminal 1</option>
      <option value="Terminal 2" {% if laporan.terminal == "Terminal 2" %}selected{% endif %}>Terminal 2</option>
  </select>
</div>

<div class="form-row">
  <label for="tempat">Tempat :</label>
  <select id="tempat" name="tempat" class="form-select"
        data-tempat="{{ laporan.tempat }}" required>
      {% for t in tempat_list %}
          <option value="{{ t }}" {% if laporan.tempat == t %}selected{% endif %}>
              {{ t }}
          </option>
      {% endfor %}
  </select>
</div>

<div id="lokasiLainContainer" style="display:none;">
  <label for="lokasi_lain">Tulis Lokasi Lainnya :</label>
  <input
    type="text"
    id="lokasi_lain"
    name="lokasi_lain"
    placeholder="Contoh: Toilet dekat Gate D"
    value="{{ laporan.lokasi_lain or '' }}">
</div>

<input type="hidden" id="lokasi" name="lokasi" value="{{ laporan.lokasi }}">
<div class="data-row">
  <span>Deskripsi :</span>
  <textarea name="deskripsi" rows="2">{{ laporan.deskripsi }}</textarea>
</div>

      <div class="data-row">
        <span>Catatan :</span>
        <textarea name="catatan" rows="2">{{ laporan.catatan }}</textarea>
      </div>
    </div>

    <!-- === WAKTU & STATUS === -->
    <div class="data-section">
      <h3>Waktu & Status</h3>

      <div class="data-row">
        <span>Tanggal Kehilangan :</span>
        <strong>{{ laporan.tanggal_kehilangan }}</strong>
      </div>

      <div class="data-row">
        <span>Tanggal Submit :</span>
        <strong>{{ laporan.tanggal_submit }} {{ laporan.waktu_submit }}</strong>
      </div>

      <div class="data-row">
        <span>Update Terakhir :</span>
        <strong>{{ laporan.update_terakhir }}</strong>
      </div>

      <div class="data-row">
        <span>Status :</span>
        <select id="status" name="status" class="status-select">
          <option value="Pending" {% if laporan.status == 'Pending' %}selected{% endif %}>Pending</option>
          <option value="Verifikasi" {% if laporan.status == 'Verifikasi' %}selected{% endif %}>Verifikasi</option>
          <option value="Dalam Pencarian" {% if laporan.status == 'Dalam Pencarian' %}selected{% endif %}>Dalam Pencarian</option>
          <option value="Barang Ditemukan" {% if laporan.status == 'Barang Ditemukan' %}selected{% endif %}>Barang Ditemukan</option>
          <option value="Selesai" {% if laporan.status == 'Selesai' %}selected{% endif %}>Selesai</option>
        </select>
      </div>
    </div>

          <!-- === BUTTON === -->
          <div class="button-group">
            <button onclick="window.location.href='{{ url_for('admin_bp.beranda_admin') if request.args.get('from') == 'beranda' else url_for('admin_bp.daftar_kehilangan') }}'" 
                    id="btnKembali" 
                    class="btn btn-secondary">
              Kembali
            </button>
            <button type="submit" class="btn btn-primary">Simpan Perubahan</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="{{ url_for('admin_bp.static', filename='js/edit_kehilangan.js') }}"></script>
  <script src="{{ url_for('admin_bp.static', filename='js/logout.js') }}"></script>
</body>
</html>
